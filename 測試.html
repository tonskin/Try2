<section id="try-on-app">
    <h2 style="text-align:center; margin-bottom:10px; color:#7a6f8a; font-family:'Noto Serif TC',serif;">
        Lip Simulation
        <span style="font-size:0.6em; color:#a790b8; display:block; margin-top:5px; letter-spacing:1px;">
            ÂîáËâ≤Ê®°Êì¨Á¥îÊ∑®Áâà
        </span>
    </h2>
    
    <div class="app-container">
        <div class="preview-box">
            <p id="upload-hint">
                <span style="font-size: 2em; opacity: 0.3;">üì∑</span>
                <span>ÈªûÊìä‰∏äÂÇ≥ÁÖßÁâá</span>
            </p>
            <img id="user-photo" src="" style="display:none;">
            
            <div id="lip-mask" class="lip-overlay">
                <svg viewBox="0 0 200 100" preserveAspectRatio="none">
                    <path d="M10,40 Q50,60 100,40 Q150,60 190,40 Q150,80 100,90 Q50,80 10,40 Z M15,40 Q50,20 100,30 Q150,20 185,40 Q150,50 100,50 Q50,50 15,40" />
                </svg>
            </div>
            <input type="file" id="photo-input" accept="image/*">
        </div>

        <div class="controls" id="control-panel" style="display:none;">
            <div class="color-palette">
                <div class="color-btn" style="background:#E59595;" onclick="changeColor('#E59595')"></div>
                <div class="color-btn" style="background:#D65656;" onclick="changeColor('#D65656')"></div>
                <div class="color-btn" style="background:#E07B5C;" onclick="changeColor('#E07B5C')"></div>
                <div class="color-btn" style="background:#B05C5C;" onclick="changeColor('#B05C5C')"></div>
            </div>

            <div class="slider-row">
                <div class="slider-group">
                    <label>Position</label>
                    <input type="range" min="0" max="100" value="50" oninput="moveLip('x', this.value)">
                    <input type="range" min="0" max="100" value="50" oninput="moveLip('y', this.value)">
                </div>
                <div class="slider-group">
                    <label>Scale</label>
                    <input type="range" min="10" max="150" value="50" oninput="resizeLip(this.value)">
                    <label style="margin-top:5px;">Opacity</label>
                    <input type="range" min="0.1" max="1" step="0.1" value="0.6" oninput="opacityLip(this.value)">
                </div>
            </div>
        </div>
    </div>
</section>

<style>
    #try-on-app {
        background: #ffffff; 
        padding: 40px 20px;
    }
    .app-container {
        max-width: 420px; 
        margin: 0 auto; 
        box-shadow: 0 10px 40px rgba(0,0,0,0.06);
        border-radius: 20px;
        overflow: hidden;
        background: #fff;
        border: 1px solid #f0f0f0;
    }
    .preview-box {
        width: 100%; height: 350px; 
        background-color: #f7f7f7; 
        position: relative; 
        overflow: hidden; 
        display: flex; 
        align-items: center; 
        justify-content: center; 
        cursor: pointer;
    }
    #user-photo { width: 100%; height: 100%; object-fit: cover; }
    #upload-hint { 
        color: #aaa; font-weight: 400; font-size: 0.95em;
        display: flex; flex-direction: column; align-items: center; gap: 10px;
        pointer-events: none;
    }
    #photo-input { position: absolute; width: 100%; height: 100%; opacity: 0; cursor: pointer; z-index: 10; }
    
    .lip-overlay {
        position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); 
        width: 100px; height: 50px; 
        pointer-events: none; 
        display: none; 
        mix-blend-mode: multiply; 
        opacity: 0.6;
    }
    .lip-overlay svg { width: 100%; height: 100%; fill: #E59595; filter: blur(5px); }
    
    .controls { padding: 25px; background: #fff; }
    .color-palette { 
        display: flex; justify-content: center; gap: 20px; margin-bottom: 25px; 
    }
    .color-btn {
        width: 32px; height: 32px; border-radius: 50%; cursor: pointer; 
        position: relative;
        border: 2px solid #fff;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .color-btn:hover { transform: scale(1.1); }

    .slider-row {
        display: flex; justify-content: space-between; gap: 15px; margin-bottom: 15px;
    }
    .slider-group {
        flex: 1; display: flex; flex-direction: column; gap: 8px;
    }
    .slider-group label {
        font-size: 0.75rem; color: #bbb; text-transform: uppercase; letter-spacing: 1px; text-align: center;
    }
    .slider-group input { 
        width: 100%; accent-color: #7a6f8a; height: 4px; background: #eee; border-radius: 2px;
    }
</style>

<script>
    // Ë©¶Â¶ùAPP ÈÇèËºØ
    const photoInput = document.getElementById('photo-input');
    const userPhoto = document.getElementById('user-photo');
    const uploadHint = document.getElementById('upload-hint');
    const controlPanel = document.getElementById('control-panel');
    const lipMask = document.getElementById('lip-mask');
    const lipSvg = lipMask.querySelector('svg');

    photoInput.addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                userPhoto.src = e.target.result;
                userPhoto.style.display = 'block';
                uploadHint.style.display = 'none';
                controlPanel.style.display = 'block'; 
                lipMask.style.display = 'block'; 
            }
            reader.readAsDataURL(file);
        }
    });

    function changeColor(color) {
        lipSvg.style.fill = color;
    }

    function moveLip(axis, val) {
        if(axis === 'x') {
            lipMask.style.left = val + '%';
        } else {
            lipMask.style.top = val + '%';
        }
    }

    function resizeLip(val) {
        lipMask.style.width = (val * 1.5) + 'px';
        lipMask.style.height = (val * 0.75) + 'px';
    }

    function opacityLip(val) {
        lipMask.style.opacity = val;
    }
</script>